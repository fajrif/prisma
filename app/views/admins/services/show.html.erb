<% title_page("Service details") %>
<div class="row">
	<div class="col-md-12 col-sm-12">
		<div class="card card-box">
			<div class="card-body">
				<ul class="nav nav-tabs mb-3" role="tablist">
					<li class="nav-item" role="presentation">
						<a class="nav-link active" data-bs-toggle="tab" href="#details" role="tab" aria-selected="true">
								Details
						</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" data-bs-toggle="tab" href="#benefits" role="tab" aria-selected="false" tabindex="-1">
							<%= "Benefits (#{ @service.benefits.size })" %>
						</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" data-bs-toggle="tab" href="#segments" role="tab" aria-selected="false" tabindex="-1">
							<%= "Segments (#{ @service.segments.size })" %>
						</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active show" id="details" role="tabpanel">
						<%= render "details" %>
					</div>
					<div class="tab-pane" id="benefits" role="tabpanel">
						<div class="row">
							<div class="col-12">
								<div class="row">
									<div class="col-sm-auto ms-auto" style="padding-bottom:20px;">
										<div class="hstack gap-2">
											<%= link_to new_admins_service_benefit_path(@service.id), class: "btn btn-success add-btn", remote: true do %>
												<i class="ri-add-line align-bottom me-1"></i> Add Benefit</a>
											<% end %>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-12 mb-3" style="min-height:200px;" id="serviceBenefitsTable">
										<%= render "admins/services/benefits/table" %>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="segments" role="tabpanel">
						<div class="row">
							<div class="col-12">
								<div class="row">
									<div class="col-sm-auto ms-auto" style="padding-bottom:20px;">
										<div class="hstack gap-2">
											<%= link_to new_admins_service_segment_path(@service.id), class: "btn btn-success add-btn", remote: true do %>
												<i class="ri-add-line align-bottom me-1"></i> Add Segment</a>
											<% end %>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-12 mb-3" style="min-height:200px;" id="serviceSegmentsTable">
										<%= render "admins/services/segments/table" %>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<%= content_for :tail do %>
	<%= javascript_include_tag "jquery-ui/widget" %>
	<%= javascript_include_tag "jquery-ui/widgets/sortable" %>
	<script>
		$(document).on('ready page:load', function () {
			$("#contents").sortable({
				handle: '.handle',
				update: function(e, ui) {
					$.ajax({
							url: $(this).data("url"),
							type: "PATCH",
							data: $(this).sortable('serialize'),
							dataType: 'script',
							error: function() {
									console.log('Unable to use jquery-ui sortable');
							}
					});
				}
			});
			$("#contents1").sortable({
				handle: '.handle',
				update: function(e, ui) {
					$.ajax({
							url: $(this).data("url"),
							type: "PATCH",
							data: $(this).sortable('serialize'),
							dataType: 'script',
							error: function() {
									console.log('Unable to use jquery-ui sortable');
							}
					});
				}
			});
		});
	</script>
	<style>
		.ui-sortable-handle{
			cursor: pointer;
		}
	</style>
<% end %>

